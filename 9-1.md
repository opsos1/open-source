# **:repeat: 다시시작**
한 두줄 변경된 코드는 언제든 다시 시작할 수 있지만,<br>
몇 시간, 며칠을 작업한 코드의 경우 쉽지 않습니다.<br>
<br>
이때 깃에서 `reset`과 `revert`를 통해 기록된 커밋을 기준으로 이전 상태로 되돌릴 수 있습니다.

## **실습**
### 새 깃 저장소 초기화
```bash
$ cd 실습폴더  # 실습 폴더의 부모 폴더로 이동
$ mkdir gitstudy09  # 실습 폴더 생성
$ cd gitstudy09  # 실습할 폴더로 이동

infoh@DESKTOP MINGW64 /e/gitstudy09
$ git init  # 저장소 초기화
> Initialized empty Git repository in E:/gitstudy09/.git/
```

### menu.htm 파일 생성 및 수정
```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ code menu.htm # 파일 수정/저장을 위한 VS Code 실행
```
`menu.htm`
```html
<ul>
</ul>
```

### **:pencil2: menu.htm 스테이징&커밋**
실습을 위해 총 6번의 커밋을 진행합니다.<br>

**첫 번째 커밋**
```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git add menu.htm  # 스테이징

infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git commit -m "first"  # 커밋
[master (root-commit) 69bf712] first
>  1 file changed, 2 insertions(+)
>  create mode 100644 menu.htm
```
<!-------------------------------------------------------------->
<details>
<summary>

**:two: menu.htm 두 번째 커밋**

</summary>

`menu.htm`
```html
<ul>
    <li>menu1</li>
</ul>
```

```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git commit -am “menu1” menu1 등록 및 커밋
> [master b741eef] menu1
>  1 file changed, 1 insertion(+)
```

</details>
<!-------------------------------------------------------------->
<details>
<summary>

**:three: menu.htm 세 번째 커밋**

</summary>

`menu.htm`
```html
<ul>
    <li>menu1</li>
    <li>menu2</li>
</ul>
```

```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git commit -am "menu2" menu2 등록 및 커밋
> [master f1c704f] menu2
>  1 file changed, 1 insertion(+)
```
</details>
<!-------------------------------------------------------------->
<details>
<summary>

**:four: menu.htm 네 번째 커밋**

</summary>

`menu.htm`
```html
<ul>
    <li>menu1</li>
    <li>menu2</li>
    <li>menu3</li>
</ul>
```

```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git commit -am "menu3"
> [master b728366] menu3
>  1 file changed, 1 insertion(+)
```

</details>
<!-------------------------------------------------------------->
<details>
<summary>

**:five: menu.htm 다섯 번째 커밋**

</summary>

`menu.htm`
```html
<ul>
    <li>menu1</li>
    <li>menu2</li>
    <li>menu3</li>
    <li>menu4</li>
</ul>
```

```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git commit -am "menu4"
> [master 6619c99] menu4
>  1 file changed, 1 insertion(+)
```
</details>
<!-------------------------------------------------------------->
<details>
<summary>

**:six: menu.htm 여섯 번째 커밋**

</summary>

`menu.htm`
```html
<ul>
    <li>menu1</li>
    <li>menu2</li>
    <li>menu3</li>
    <li>menu4</li>
    <li>menu5</li>
</ul>
```

```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git commit -am “menu5” menu5 등록 및 커밋
> [master 7f068b6] menu5
>  1 file changed, 1 insertion(+)
```
</details>

### **소스트리에서 커밋 확인**
<kbd>
<img src="https://user-images.githubusercontent.com/45596014/201471781-d76d0432-24a2-4ccc-baef-901cdc11c31b.png">
</kbd>

## **:red_circle: 리셋**
`reset` 은 커밋을 기준으로 이전 코드로 되돌리는 방법으로,<br>
기록한 커밋을 취소합니다.
> ※ 커밋을 취소하는 만큼 리셋할 때는 항상 신중하게 작업해야 합니다.

<kbd>
<img src="https://user-images.githubusercontent.com/45596014/201472174-43881234-a4e4-4620-b619-dab20578ee88.png">
</kbd>

### **복귀 시점**
이전 코드로 복귀하려면 복귀 시점을 알려 주어야 합니다.<br>
`reset` 은 이 시점을 `commit` 을 기준으로 정합니다.<br>
> ※ 커밋은 `log` 명령을 통해 해시 값을 조회할 수 있고,<br>
> ※ 이는 복귀할 특정 시점을 찾는 데 매우 유용합니다.

**로그 기록 확인**<br>
- `reset` 을 사용하기 전 커밋의 해시 값을 확인해야합니다.<br>
- 이때 `commit message` 는 특정 commit 시점을 파악하기에 매우 중요합니다.<br>

    > ※ 실습 시 커밋의 해시 값이 중요하며,<br>
    > ※ 본 예시에서 출력된 해시 값이 아닌 본인 로그의 해시 값을 확인해야 합니다.

    > ※  해시 값을 사용하지 않아도, HEAD 포인터를 통해 상대적 위치를 지정할 수 있습니다.<br>
    > &nbsp;&nbsp;&nbsp;&nbsp;`$ git reset -hard HEAD^^^`

```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git log –oneline 로그 확인

> 7f068b6 (HEAD -> master) menu5
> 6619c99 menu4
> b728366 menu3
> f1c704f menu2
> b741eef menu1
> 69bf712 first
```

<kbd>
<img src="https://user-images.githubusercontent.com/45596014/201472325-a0df5f35-d1cc-4310-b57b-bdd00aaccd81.png">
</kbd>

<br>

### **:page_with_curl: reset 명령어**
`reset` 명령어 사용 시 특정 커밋의 해시 값 상태로 모든 코드를 복구합니다.<br>
```bash
$ git reset [옵션] [커밋ID]
```
**옵션**<br>
`reset` 명령어는 옵션을 함께 사용해야하며, 3가지 옵션이 있습니다.<br>
> ※ 기본 옵션 값은 mixed입니다. <br>
> ※ soft 옵션과 mixed 옵션 차이는 크게 스테이지 영역과 관련이 있습니다.<br>
> ※ hard 옵션은 워킹 디렉터리와 관련이 있습니다.
- **`soft`** : 스테이지 영역을 포함한 상태로 복원합니다.
- **`mixed`** : reset 명령어를 사용할 때 옵션을 지정하지 않으면 기본값인 mixed로 선택됩니다.
- **`hard`** : 실제 파일이 삭제된 이전 상태로 복원합니다.

### **soft 옵션**
soft 옵션은 가장 낮은 단계의 리셋 동작입니다.
> ※ soft 옵션을 사용하면 별도의 메시지가 출력되지 않습니다.
```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git reset –soft HEAD~  # 이전 커밋으로 soft 옵션을 사용한 리셋
```
**현재 상태**<br>
soft 옵션은 지정한 커밋 위치로 복귀하며,<br>
복귀하면서 스테이지 영역의 상태도 같이 복귀합니다<br>
- soft 옵션은 파일을 수정 후 스테이지 영역에 올려 커밋을 실행하기 직전의 단계로 되돌립니다.

> 이처럼 soft 옵션은 단순히 HEAD 위치를 이동하는 역할만 합니다.<br>
> 마치 직전의 커밋 단계로 체크아웃하라는 명령과 유사합니다.
> > ※ `reset --soft` 명령어와 체크아웃 명령어는 HEAD 위치를 이동한다는 점에서는 동일하지만,<br>
> > 브랜치를 변경하지 않는다는 점에서 차이가 있습니다.

<kbd>
<img src="https://user-images.githubusercontent.com/45596014/201474737-ca675ccd-5457-47fa-89d0-53d2e816bcba.png">
</kbd>
<!----------------------------------------------------------->
<details>
<summary>

**소스트리 확인**<br>

</summary>

- 마지막 menu5 커밋이 사라지고 커밋하지 않은 변경 사항이 보입니다.

<kbd>
<img src="https://user-images.githubusercontent.com/45596014/201473560-874bcd80-135a-4508-a076-46c09d8ae77c.png">
</kbd>
</details>
<!----------------------------------------------------------->
<details>
<summary>

**log 명령어로 확인**

</summary>

```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git log –oneline  # 로그 확인

> 6619c99 (HEAD -> master) menu4 
> b728366 menu3
> f1c704f menu2
> b741eef menu1
> 69bf712 first
```

**menu.htm 확인**<br>
reset 하기 전 내용이 그대로 남아있습니다.
```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ code menu.htm  # VS Code 실행
```
`menu.htm`
```html
<ul>
    <li>menu1</li>
    <li>menu2</li>
    <li>menu3</li>
    <li>menu4</li>
    <li>menu5</li>  <!--menu5가 남아 있음-->
</ul>
```
</details>
<!----------------------------------------------------------->
<details>
<summary>

**diff를 통한 차이 확인**<br>

</summary>

menu.htm 파일에 새로운 menu5가 추가된 것을 확인할 수 있습니다.
```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git diff HEAD  # 커밋 비교
> diff –git a/menu.htm b/menu.htm
> index f717854..9ae7cfc 100644
> — a/menu.htm
> +++ b/menu.htm
> @@ -3,4 +3,5 @@
>      <li>menu2</li>
>      <li>menu3</li>
>      <li>menu4</li>
> +    <li>menu5</li>  # 파일 수정이 추가됨
>  </ul>
> \ No newline at end of file
```
</details>
<!----------------------------------------------------------->
<details>
<summary>

**status를 통한 상태 확인**

</summary>

메뉴 파일은 수정된 상태이며,<br>
수정된 파일은 스테이지 영역에 등록되어 있습니다.
> ※ status 명령어를 실행한 출력 결과에서 메시지가 초록색으로 표기되는 것을 보면,<br>
> add 명령어를 사용하지 않고도 바로 커밋할 수 있는 직전의 상황입니다.

```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git status  # 상태 확인
> On branch master
> Changes to be committed:
>   (use “git reset HEAD <file>…” to unstage)
>  modified: menu.htm  # 파일이 변경된 상태
```

</details>

<br>

**menu5 재 커밋**
처음과 동일한 상태가 된 것을 확인할 수 있습니다.
> ※ 새로 커밋을 했기 때문에 처음 커밋 해시 값과는 다른 것을 볼 수 있습니다.<br>
> ※ reset –soft 명령어의 원리를 이용하면 마지막 커밋을 수정할 수 있습니다.<br>
> &nbsp;&nbsp;&nbsp;&nbsp;마치 –amend 명령어와 유사합니다.
```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git commit -m "menu5"  # 다시 커밋
> [master 34df5c3] menu5
>  1 file changed, 1 insertion(+)
```
<kbd>
<img src="https://user-images.githubusercontent.com/45596014/201513832-e24ed033-5e0a-4330-84d7-6b8a49c240a5.png">
</kbd>

<br>

**log 확인**
```bash
infoh@DESKTOP MINGW64 /e/gitstudy09 (master)
$ git log –oneline 로그 확인
> 34df5c3 (HEAD -> master) menu5  # 커밋 해시 값이 변경됨
> 6619c99 menu4
> b728366 menu3
> f1c704f menu2
> b741eef menu1
> 69bf712 first
```